name = "aispeeds"
# Next.js with OpenNext Cloudflare
main = ".open-next/worker.js"
compatibility_date = "2025-05-30"
compatibility_flags = ["nodejs_compat", "global_fetch_strictly_public"]

routes = [
  { pattern = "cc.xiaohui.cool", custom_domain = true },
  { pattern = "aispeeds.me", custom_domain = true },
]

# Assets configuration for Next.js
[assets]
binding = "ASSETS"
directory = ".open-next/assets"

# Build configuration for client scripts (legacy, still needed for client modules)
[build]
command = "npm run build:client"
watch_dir = ["src/client"]

[vars]
# Use '*' to allow any host, or a comma-separated list of exact hostnames
# e.g. "images.unsplash.com,cdn.jsdelivr.net"
IMAGE_PROXY_WHITELIST = "*"
# Cache TTL in seconds for proxied images
IMAGE_PROXY_CACHE_TTL = "86400"

# Enable logging
[observability]
enabled = true
head_sampling_rate = 1

# Assets configuration for static files (disabled - using new modular system)
# [assets]
# directory = "./static"
# binding = "ASSETS"
