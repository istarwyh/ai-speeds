# AI Speeds - Claude Code Router

**AI Speeds** æ˜¯ä¸€ä¸ªAIå·¥å…·è‡ªæˆ‘å±•ç¤ºå’ŒAIç”Ÿæˆå†…å®¹èšåˆå¹³å°ï¼ŒæœåŠ¡äºå¸Œæœ›å‘ç°å’Œä½“éªŒAIèƒ½åŠ›çš„ä¸“ä¸šäººå£«ä¸å­¦ä¹ è€…ã€‚æˆ‘ä»¬è®©AIå·¥å…·ä»¥Agentèº«ä»½è‡ªæˆ‘ä»‹ç»ã€å±•ç¤ºèƒ½åŠ›ï¼Œå¹¶ç”Ÿæˆå®é™…åº”ç”¨æ¡ˆä¾‹ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥ä½“éªŒAIå·¥å…·çš„çœŸå®ä»·å€¼ã€‚

é€šè¿‡AIå·¥å…·ä½œä¸º"è™šæ‹Ÿåˆ›ä½œè€…"çš„åˆ›æ–°æ¨¡å¼ï¼Œæˆ‘ä»¬è®©AIèƒ½åŠ›å‘ç°å˜å¾—ç›´è§‚æœ‰è¶£ï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½ç›´æ¥æ„Ÿå—AIçš„å®é™…ä»·å€¼ã€‚

## âœ¨ å¹³å°ç‰¹è‰²

### ğŸ¤– AIå·¥å…·å‘ç°ä¸æ¨è
- **æ™ºèƒ½å‘ç°**: å¸®åŠ©ç”¨æˆ·å‘ç°å¸‚é¢ä¸Šå¥½ç”¨çš„AIå·¥å…·
- **çœŸå®è¯„ä»·**: æä¾›æ¥è‡ªçœŸå®ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒå’Œæ•ˆæœåé¦ˆ
- **ä¸ªæ€§åŒ–æ¨è**: åŸºäºç”¨æˆ·éœ€æ±‚æ¨èæœ€é€‚åˆçš„AIå·¥å…·
- **å³ç”¨æŒ‡å—**: æ¯ä¸ªå·¥å…·éƒ½æä¾›è¯¦ç»†çš„ä¸Šæ‰‹æ•™ç¨‹

### ğŸ“š AIåº”ç”¨æ¡ˆä¾‹åˆ†äº«
- **åœºæ™¯åŒ–å±•ç¤º**: å…·ä½“çš„AIåº”ç”¨æ¡ˆä¾‹å’Œä½¿ç”¨æ­¥éª¤
- **å¯å¤åˆ¶ç»éªŒ**: æä¾›å¯ç›´æ¥å¥—ç”¨çš„æˆåŠŸä½¿ç”¨æ¨¡å¼
- **æ•ˆæœå±•ç¤º**: çœŸå®çš„AIåº”ç”¨æ•ˆæœå’Œæ”¶ç›Šæ•°æ®
- **ç¤¾åŒºäº’åŠ¨**: ç”¨æˆ·å¯åˆ†äº«è‡ªå·±çš„AIä½¿ç”¨å¿ƒå¾—

### ğŸŒ± AIå­¦ä¹ æˆé•¿ç¤¾åŒº
- **åŒä¼´å­¦ä¹ **: ä¸åŒæ ·åœ¨å­¦ä¹ AIçš„ç”¨æˆ·äº¤æµäº’åŠ¨
- **ä¸“å®¶æŒ‡å¯¼**: è·å¾—AIåº”ç”¨ä¸“å®¶çš„æŒ‡å¯¼å’Œå»ºè®®
- **æŒç»­æ¿€åŠ±**: å»ºç«‹AIå­¦ä¹ çš„ç¤¾äº¤ç½‘ç»œå’ŒåŠ¨åŠ›æœºåˆ¶
- **çŸ¥è¯†å…±äº«**: å½¢æˆäº’åŠ©å‹çˆ±çš„AIå­¦ä¹ ç¤¾åŒºæ–‡åŒ–

### ğŸ”® AIè¶‹åŠ¿ä¸æ´å¯Ÿ
- **å‰æ²¿èµ„è®¯**: ç²¾é€‰å¯¹æ™®é€šç”¨æˆ·æœ‰å®é™…æ„ä¹‰çš„AIè¶‹åŠ¿
- **æ·±åº¦è§£è¯»**: ç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šå¤æ‚çš„AIå‘å±•
- **è¡ŒåŠ¨æŒ‡å¯¼**: æä¾›å…·ä½“çš„å‰ç»æ€§å¸ƒå±€å’Œè¡ŒåŠ¨å»ºè®®
- **é¿å…è¿‡è½½**: è¿‡æ»¤å™ªéŸ³ï¼Œä¸“æ³¨æœ‰ä»·å€¼çš„ä¿¡æ¯

### ğŸ› ï¸ Claude Code Router (é›†æˆåŠŸèƒ½)
- **ğŸ”„ API Translation**: Anthropic â†” OpenAI format conversion
- **ğŸŒ Multi-Provider**: OpenRouter, OpenAI, DeepSeek, Kimi, SiliconFlow, AnyRouterç­‰
- **âš¡ Edge Computing**: Next.js Edge Runtime + Cloudflare Workers
- **ğŸ“¡ Streaming Support**: Real-time response streaming

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¹³å°å¯¼èˆª

è®¿é—® [AI Speeds](https://cc.xiaohui.cool) å¹³å°ï¼Œæ¢ç´¢å››ä¸ªæ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼š

#### ğŸ¯ é€‰æ‹©ä½ çš„ä½¿ç”¨åœºæ™¯

**æ–°æ‰‹ç”¨æˆ·** â†’ [å¦‚ä½•ç”¨ä¸Š CC](https://cc.xiaohui.cool/get-started) - å¿«é€Ÿé…ç½®æŒ‡å—<br>
**è¿›é˜¶ç”¨æˆ·** â†’ [å¦‚ä½•ç”¨å¥½ CC](https://cc.xiaohui.cool/best-practices) - æœ€ä½³å®è·µæŠ€å·§<br>
**æŠ€æœ¯ç”¨æˆ·** â†’ [å¦‚ä½•å®ç° CC](https://cc.xiaohui.cool/how-to-implement) - æ¶æ„åŸç†è§£æ<br>
**å¼€å‘è€…** â†’ [å¦‚ä½•è¿ç”¨ CC](https://cc.xiaohui.cool/how-to-apply-cc) - SDKå¼€å‘æŒ‡å—

### 1. å®‰è£… Claude Code

```bash
pnpm add -g @anthropic-ai/claude-code
```

### 2. é…ç½® API è®¿é—®

```bash
# é€‰é¡¹ A: ä½¿ç”¨å…±äº«å®ä¾‹ï¼ˆä»…æµ‹è¯•ï¼‰
export ANTHROPIC_BASE_URL="https://cc.xiaohui.cool"
export ANTHROPIC_API_KEY="your-provider-api-key"

# é€‰é¡¹ B: éƒ¨ç½²ç§æœ‰å®ä¾‹ï¼ˆæ¨èï¼‰
git clone https://github.com/your-username/claude-code-router
cd claude-code-router && wrangler deploy
export ANTHROPIC_BASE_URL="https://your-domain.workers.dev"
```

### 3. å¼€å§‹ä½¿ç”¨ Claude Code

```bash
source ~/.bashrc && claude
```

### æ”¯æŒçš„AIæä¾›å•†

| æä¾›å•† | çŠ¶æ€ | ç‰¹è‰² | å…è´¹é¢åº¦ | æ³¨å†Œé“¾æ¥ |
|--------|------|------|----------|----------|
| **DeepSeek** | âœ… å³ç”¨ | é«˜æ€§èƒ½æ¨ç†æ¨¡å‹ï¼Œæ€§ä»·æ¯”æä½³ | æœ‰ | [platform.deepseek.com](https://platform.deepseek.com) |
| **AnyRouter** | âœ… å³ç”¨ | ğŸ $100å…è´¹é¢åº¦ï¼Œå¤šæ¨¡å‹æ”¯æŒ | **$100** | [anyrouter.top](https://anyrouter.top/console/token?aff=4Ly0) |
| **Kimi** | âœ… å³ç”¨ | ä¸­æ–‡AIæ¨¡å‹ï¼Œå¤šè¯­è¨€èƒ½åŠ›å¼º | æœ‰ | [platform.moonshot.cn](https://platform.moonshot.cn) |
| **SiliconFlow** | âœ… å³ç”¨ | ä¸­æ–‡AIåŸºç¡€è®¾æ–½å¹³å° | æœ‰ | [siliconflow.cn](https://siliconflow.cn) |
| **Qwen3-Coder** | âœ… å³ç”¨ | é˜¿é‡Œäº‘ç¼–ç¨‹æ¨¡å‹ï¼Œä¸­æ–‡æ”¯æŒå¥½ | æœ‰ | [dashscope.console.aliyun.com](https://dashscope.console.aliyun.com) |
| **AICodeWith** | âœ… å³ç”¨ | ğŸ 2000å…è´¹é¢åº¦ï¼Œç›´æ¥APIè®¿é—® | **2000ç§¯åˆ†** | [aicodewith.com](https://aicodewith.com/?invitation=VI84XXSW) |
| **Claude-Code** | âœ… å³ç”¨ | ğŸ **6000**å…è´¹é¢åº¦ï¼Œä¸“ä¸šæœåŠ¡ | **6000ç§¯åˆ†** | [claude-code.top](https://www.claude-code.top/register?inviteCode=5GTISY) |
| **Anthropic** | âœ… å®˜æ–¹ | å®˜æ–¹Claude APIï¼Œéœ€è§£å†³å……å€¼é—®é¢˜ | æœ‰ | [claude.ai](https://claude.ai) |
| **OpenRouter** | âš ï¸ éƒ¨ç½² | å¤šæ¨¡å‹èšåˆå¹³å° | æœ‰ | [openrouter.ai](https://openrouter.ai) |
| **OpenAI** | âš ï¸ éƒ¨ç½² | è¡Œä¸šé¢†å…ˆçš„GPTæ¨¡å‹ | æœ‰ | [platform.openai.com](https://platform.openai.com) |

### æä¾›å•†é…ç½®

| Provider   | API Key Source                                         | Base URL                        |
| ---------- | ------------------------------------------------------ | ------------------------------- |
| OpenRouter | [openrouter.ai](https://openrouter.ai)                 | `https://cc.xiaohui.cool`       |
| DeepSeek   | [platform.deepseek.com](https://platform.deepseek.com) | Deploy with `DEEPSEEK_BASE_URL` |
| OpenAI     | [platform.openai.com](https://platform.openai.com)     | Deploy with `OPENAI_BASE_URL`   |

## ğŸ—ï¸ å¹³å°æ¶æ„

### å†…å®¹èšåˆå¹³å°æ¶æ„
```mermaid
graph TB
    A[ç”¨æˆ·è®¿é—®] -->|Next.js App Router| B[AI Speedså¹³å°]
    B -->|LegacyPageWrapperé€‚é…å™¨| C[å†…å®¹æ¨¡å—ç³»ç»Ÿ]
    C -->|Get Started| D[æ–°æ‰‹æŒ‡å—æ¨¡å—]
    C -->|Best Practices| E[æœ€ä½³å®è·µæ¨¡å—] 
    C -->|How to Implement| F[æŠ€æœ¯æ¶æ„æ¨¡å—]
    C -->|How to Apply| G[å¼€å‘æŒ‡å—æ¨¡å—]
    
    B -->|å®¢æˆ·ç«¯äº¤äº’| H[åŠ¨æ€å†…å®¹åŠ è½½]
    H -->|JavaScript| I[æ¨¡å—åŒ–HTMLæ¨¡æ¿]
    
    subgraph "Cloudflare Workersè¾¹ç¼˜ç½‘ç»œ"
        B
        H
        I
    end

    style A fill:#e1f5fe
    style B fill:#fff3e0
    style C fill:#e8f5e8
```

### APIä»£ç†æœåŠ¡æ¶æ„
```mermaid
graph TB
    A[Claude Code Client] -->|Anthropic API Format| B[Claude-Code-Router]
    B -->|Provider Selection| C{Environment Config}
    C -->|OpenRouter| D[OpenRouter API]
    C -->|DeepSeek| E[DeepSeek API]
    C -->|OpenAI| F[OpenAI API]
    C -->|Others| G[Other OpenAI-Compatible APIs]

    B -->|Format Conversion| H[Request Translator]
    B -->|Response Processing| I[Response Translator]
    B -->|Streaming| J[SSE Handler]

    subgraph "Cloudflare Workers"
        B
        H
        I
        J
    end

    style A fill:#e1f5fe
    style B fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#e8f5e8
    style F fill:#fff8e1
    style G fill:#fce4ec
```

## ğŸ’¡ å¹³å°ä»·å€¼ä¸»å¼ 

### ğŸ¯ ä½¿å‘½
**è®©æ¯ä¸ªäººéƒ½èƒ½æŒæ¡AIåŠ é€Ÿè‡ªå·±å·¥ä½œå­¦ä¹ æˆé•¿çš„æ–¹æ³•ï¼Œåœ¨AIæ—¶ä»£ä¸æ‰é˜Ÿã€æ›´è¿›æ­¥**

### ğŸŒŸ æ ¸å¿ƒä»·å€¼
- **å®ç”¨ä¼˜å…ˆ**: æ‰€æœ‰å†…å®¹èšç„¦äºå¯ç›´æ¥åº”ç”¨çš„AIå·¥å…·å’Œæ–¹æ³•ï¼Œé¿å…ç©ºæ´ç†è®º
- **çœŸå®å¯ä¿¡**: å±•ç¤ºçœŸå®ç”¨æˆ·çš„AIåº”ç”¨ä½“éªŒå’Œå®é™…æ•ˆæœï¼Œå»ºç«‹å¯ä¿¡èµ–çš„ç¤¾åŒºæ°›å›´  
- **åŠ é€Ÿæˆé•¿**: å¼ºè°ƒAIå¦‚ä½•æ˜¾è‘—æå‡å·¥ä½œæ•ˆç‡å’Œå­¦ä¹ æˆæœï¼Œä½“ç°é€Ÿåº¦ä»·å€¼
- **é€šä¿—æ˜“æ‡‚**: ç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡ŠAIåº”ç”¨ï¼Œé™ä½æ™®é€šç”¨æˆ·çš„ä½¿ç”¨é—¨æ§›
- **åˆ†äº«æ–‡åŒ–**: é¼“åŠ±ç”¨æˆ·ä¸»åŠ¨åˆ†äº«AIä½¿ç”¨å¿ƒå¾—ï¼Œå½¢æˆçŸ¥è¯†å…±äº«çš„ç¤¾åŒºæ–‡åŒ–
- **æŒç»­æˆé•¿**: å…³æ³¨ç”¨æˆ·åœ¨AIæ—¶ä»£çš„æŒç»­å­¦ä¹ å’Œèƒ½åŠ›æå‡

### ğŸ” è§£å†³çš„æ ¸å¿ƒé—®é¢˜
å½“ç”¨æˆ·é¢ä¸´å·¥ä½œæ•ˆç‡ç“¶é¢ˆæˆ–å­¦ä¹ æŒ‘æˆ˜æ—¶ï¼Œä»–ä»¬å¸Œæœ›æ‰¾åˆ°AIå·¥å…·æ¥åŠ é€Ÿè§£å†³é—®é¢˜ï¼Œä½†å´ä¸çŸ¥é“å“ªäº›AIå·¥å…·çœŸæ­£æœ‰æ•ˆã€å¦‚ä½•æ­£ç¡®ä½¿ç”¨ï¼Œæˆ–è€…æ‹…å¿ƒå°è¯•æˆæœ¬è¿‡é«˜ã€‚ç°æœ‰çš„AIä¿¡æ¯è¿‡äºæŠ€æœ¯åŒ–æˆ–å•†ä¸šåŒ–ï¼Œç¼ºä¹æ¥è‡ªçœŸå®ç”¨æˆ·çš„å®è·µç»éªŒå’Œå¯ä¿¡èµ–çš„ä½¿ç”¨æŒ‡å—ï¼Œå¯¼è‡´ç”¨æˆ·åœ¨AIåº”ç”¨ä¸ŠçŠ¹è±«ä¸å†³æˆ–æ•ˆæœä¸ä½³ã€‚

å¯¹äºé«˜çº§ç”¨æˆ·ï¼Œä¹Ÿç¼ºä¹æ¥è‡ªä¸€çº¿çš„Agentæ„å»ºæŒ‡å—ã€‚

## âš¡ Technical Stack

### Core Runtime

- **Framework**: Next.js 15 with App Router
- **Frontend**: React 19 + Tailwind CSS 3
- **Platform**: Cloudflare Workers via OpenNext
- **Language**: TypeScript with strict typing
- **Runtime**: Edge Runtime (V8 Isolates)
- **Deployment**: OpenNext Cloudflare + Wrangler CLI

### Architecture Patterns

| Pattern            | Implementation           | Benefit                         |
| ------------------ | ------------------------ | ------------------------------- |
| **Edge Computing** | 300+ global locations    | <1ms cold start, 0ms warm start |
| **React Server**   | Next.js App Router       | SEO-friendly, fast page loads   |
| **Type Safety**    | Full TypeScript coverage | Runtime error prevention        |
| **Streaming**      | Web Streams API + SSE    | Real-time response delivery     |
| **Modular Design** | React components         | Easy testing & maintenance      |

### Build System

- **Framework**: Next.js 15 with Turbopack
- **Bundler**: esbuild for client modules
- **Module System**: ES6 with tree-shaking
- **Asset Pipeline**: TypeScript â†’ JavaScript + type checking
- **Hot Reload**: Next.js dev server with instant updates

## ğŸ”§ Deployment

### Development

```bash
git clone https://github.com/your-username/claude-code-router
cd claude-code-router
pnpm install

# Next.js Development (Recommended)
pnpm run dev:next        # Start Next.js dev server (http://localhost:3000)

# Legacy Workers Development
pnpm run build:client    # Build frontend modules
pnpm run dev             # Start Wrangler dev server
```

### Production Deployment

#### Option 1: Cloudflare Workers (Next.js)

```bash
# Build Next.js for Cloudflare
pnpm run cf:build        # Build with OpenNext Cloudflare

# Preview locally
pnpm run cf:preview      # Test before deployment

# Deploy to Cloudflare
pnpm run cf:deploy       # Deploy to production
```

#### Option 2: Traditional Deployment

```bash
# Configure environment variables
wrangler secret put OPENROUTER_BASE_URL       # OpenRouter backend
wrangler secret put DEEPSEEK_BASE_URL         # DeepSeek backend
wrangler secret put OPENAI_BASE_URL           # OpenAI backend

# Deploy to Cloudflare Workers
pnpm run deploy
```

### Environment Configuration

```mermaid
flowchart LR
    A[Environment Variables] --> B{Provider Selection}
    B -->|Priority 1| C[DEEPSEEK_BASE_URL]
    B -->|Priority 2| D[OPENAI_BASE_URL]
    B -->|Priority 3| E[KIMI_BASE_URL]
    B -->|Priority 4| F[SILICONFLOW_BASE_URL]
    B -->|Default| G[OPENROUTER_BASE_URL]

    C --> H[DeepSeek API]
    D --> I[OpenAI API]
    E --> J[Kimi API]
    F --> K[SiliconFlow API]
    G --> L[OpenRouter API]
```

## ğŸ”Œ API Reference

### Request Format (Anthropic)

```bash
curl -X POST https://cc.xiaohui.cool/v1/messages \
  -H "Content-Type: application/json" \
  -H "x-api-key: your-api-key" \
  -d '{
    "model": "claude-3-5-sonnet-20241022",
    "messages": [{"role": "user", "content": "Hello"}],
    "max_tokens": 100,
    "stream": true
  }'
```

### Model Mapping

| Claude Model                 | OpenRouter                    | DeepSeek            | OpenAI        |
| ---------------------------- | ----------------------------- | ------------------- | ------------- |
| `claude-3-5-haiku-20241022`  | `anthropic/claude-3.5-haiku`  | `deepseek-chat`     | `gpt-4o-mini` |
| `claude-3-5-sonnet-20241022` | `anthropic/claude-3.5-sonnet` | `deepseek-chat`     | `gpt-4o`      |
| `claude-3-opus-20240229`     | `anthropic/claude-3-opus`     | `deepseek-reasoner` | `gpt-4o`      |

## ğŸ“ Architecture & Structure

### Worker Runtime Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Cloudflare Workers                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”„ Request Router    â”‚ ğŸ”„ Format Converter â”‚ ğŸ“¡ Stream Handler  â”‚
â”‚ â€¢ Path matching       â”‚ â€¢ Anthropic â†’ OpenAI  â”‚ â€¢ SSE processing    â”‚
â”‚ â€¢ Method validation   â”‚ â€¢ OpenAI â†’ Anthropic  â”‚ â€¢ Chunk buffering   â”‚
â”‚ â€¢ Auth handling       â”‚ â€¢ Model mapping      â”‚ â€¢ Error recovery    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### File Structure & Frontend Architecture

```
claude-code-router/
â”œâ”€â”€ ğŸ“ src/
â”‚   â”œâ”€â”€ ğŸ“ app/                  # Next.js App Router â­
â”‚   â”‚   â”œâ”€â”€ ğŸ“ (main)/home/       # ä¸»é¡µè·¯ç”±ç»„
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ page.tsx        # ä¸»é¡µ (ä½¿ç”¨é€‚é…å™¨)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ api/               # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ v1/messages/    # Claude API ä»£ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ route.ts     # POST /api/v1/messages
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ img-proxy/      # å›¾ç‰‡ä»£ç†
â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“ route.ts     # GET /api/img-proxy
â”‚   â”‚   â”œâ”€â”€ ğŸ“ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ ğŸ“ page.tsx           # æ ¹è·¯ç”± (é‡å®šå‘)
â”‚   â”‚   â””â”€â”€ ğŸ“ globals.css        # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ ğŸ“ components-next/      # Next.js React ç»„ä»¶ â­
â”‚   â”‚   â””â”€â”€ ğŸ“ LegacyPageWrapper.tsx # é€‚é…å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ ğŸ“ api/                  # API é€‚é…å™¨å’Œç±»å‹å®šä¹‰ (å¤ç”¨)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ adapters/          # è¯·æ±‚å’Œå“åº”æ ¼å¼è½¬æ¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ format.ts       # è¯·æ±‚/å“åº”æ ¼å¼åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ stream.ts       # æµå¤„ç†
â”‚   â”‚   â”œâ”€â”€ ğŸ“ types.ts           # API ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ ğŸ“ providers.ts       # ä¾›åº”å•†é…ç½®
â”‚   â”œâ”€â”€ ğŸ“ client/               # å®¢æˆ·ç«¯æ¨¡å—åŒ–ä»£ç  (å¤ç”¨)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ bestPractices/     # æœ€ä½³å®è·µæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ ğŸ“ howToApplyCC/      # å¦‚ä½•ä½¿ç”¨ CC æ¨¡å—
â”‚   â”‚   â””â”€â”€ ğŸ“ howToImplement/    # å®ç°æŒ‡å—æ¨¡å—
â”‚   â”œâ”€â”€ ğŸ“ features/             # åŠŸèƒ½æ¨¡å— (å¤ç”¨)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ get-started/       # å¦‚ä½•ç”¨ä¸Š CC
â”‚   â”‚   â”œâ”€â”€ ğŸ“ best-practices/    # å¦‚ä½•ç”¨å¥½ CC
â”‚   â”‚   â”œâ”€â”€ ğŸ“ how-to-implement/  # å¦‚ä½•å®ç° CC
â”‚   â”‚   â””â”€â”€ ğŸ“ how-to-apply-cc/   # å¦‚ä½•è¿ç”¨ CC
â”‚   â”œâ”€â”€ ğŸ“ components/           # å¸ƒå±€ç»„ä»¶ (å¤ç”¨)
â”‚   â”œâ”€â”€ ğŸ“ styles/               # æ ·å¼ç³»ç»Ÿ (å¤ç”¨)
â”‚   â”œâ”€â”€ ğŸ“ scripts/              # è„šæœ¬ç³»ç»Ÿ (å¤ç”¨)
â”‚   â”œâ”€â”€ ğŸ“ lib/                  # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ ğŸ“ config/               # å…¨å±€é…ç½®
â”œâ”€â”€ ğŸ“ scripts/                  # æ„å»ºè‡ªåŠ¨åŒ–
â”‚   â””â”€â”€ ğŸ“ build-client.js        # å®¢æˆ·ç«¯æ¨¡å—æ‰“åŒ…
â”œâ”€â”€ ğŸ”§ next.config.mjs           # Next.js é…ç½®
â”œâ”€â”€ ğŸ”§ open-next.config.ts       # OpenNext Cloudflare é…ç½®
â””â”€â”€ âš™ï¸ wrangler.toml             # Cloudflare é…ç½®
```

### Frontend Build Architecture

The project uses a **hybrid architecture** combining Next.js and legacy modules:

#### Next.js Layer (Primary)

- **Framework**: Next.js 15 with App Router
- **Components**: React 19 components
- **Styling**: Tailwind CSS 3
- **API Routes**: Edge Runtime handlers
- **Benefits**: Modern React, SEO-friendly, type-safe

#### Legacy Adapter Layer

- **Purpose**: Reuse existing TypeScript modules without rewriting
- **Implementation**: `LegacyPageWrapper` component
- **Architecture**: Adapter pattern wrapping HTML string templates
- **Benefits**: 100% code reuse, zero migration risk

#### Build Process Flow

```mermaid
graph TB
    A[Next.js App] -->|Uses| B[LegacyPageWrapper]
    B -->|Imports| C[Legacy Modules]
    C -->|Includes| D[src/features/*]
    C -->|Includes| E[src/client/*]
    
    F[src/client/*] -->|esbuild| G[Bundled JS]
    G -->|build-client.js| H[scripts/generated/*]
    
    I[Next.js Build] -->|Outputs| J[.next/]
    J -->|OpenNext| K[Cloudflare Workers]

    style A fill:#61dafb
    style B fill:#ffd700
    style C fill:#e3f2fd
    style K fill:#f38020
```

**Migration Strategy:**

- âœ… **Phase 1**: Next.js + Adapter (Current)
- ğŸ”„ **Phase 2**: Gradual React component migration
- ğŸ¯ **Phase 3**: Remove adapter, pure Next.js

This approach ensures **zero downtime** and **100% code reuse** during migration.

### Key Design Principles

- **ğŸŒ Edge-First**: Optimized for Cloudflare's global network
- **âš›ï¸ React Modern**: Next.js 15 + React 19 architecture
- **âš¡ Performance**: Sub-millisecond response times
- **ğŸ”„ Streaming**: Native Web Streams API + SSE support
- **ğŸ›¡ï¸ Type Safety**: Full TypeScript coverage with strict mode
- **â™»ï¸ Code Reuse**: 100% legacy code reuse via adapter pattern

## ğŸ“¦ Migration to Next.js

### Why Next.js?

- âœ… **Modern Stack**: React 19, Tailwind CSS, TypeScript
- âœ… **SEO Friendly**: Server-side rendering support
- âœ… **Developer Experience**: Hot reload, type safety, modern tooling
- âœ… **Edge Runtime**: Compatible with Cloudflare Workers
- âœ… **Future Ready**: Easy to extend with React ecosystem

### Migration Highlights

- **100% Code Reuse**: All business logic preserved
- **Zero Downtime**: Gradual migration strategy
- **Minimal Changes**: Only ~600 lines of adapter code added
- **Performance**: Maintained edge runtime performance
- **Type Safety**: Enhanced TypeScript strict mode

### Migration Documentation

For detailed migration information, see:

- [`MIGRATION_FINAL_SUMMARY.md`](./MIGRATION_FINAL_SUMMARY.md) - Complete migration summary
- [`MIGRATION_PROGRESS.md`](./MIGRATION_PROGRESS.md) - Step-by-step progress
- [`UPGRADE_TO_NEXT_ARCHITECTURE.md`](./UPGRADE_TO_NEXT_ARCHITECTURE.md) - Architecture guide

## ğŸ™ Acknowledgments

Built with inspiration from:

- [claude-code-router](https://github.com/musistudio/claude-code-router)
- [claude-code-proxy](https://github.com/kiyo-e/claude-code-proxy)

## âš–ï¸ License & Disclaimer

**MIT License** - Use at your own risk and discretion.

âš ï¸ **Important**: This is an independent tool, not affiliated with Anthropic,
OpenAI, or OpenRouter. Users are responsible for compliance with all relevant
Terms of Service and API usage policies.
