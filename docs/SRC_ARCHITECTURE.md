# src/ ç›®å½•æ¶æ„è¯´æ˜

## ğŸ“Š å½“å‰è°ƒç”¨å…³ç³»ï¼ˆéš”ç¦»å‰ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Next.js App Router (æ–°)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  app/layout.tsx                                                  â”‚
â”‚  â””â”€â”€ æ³¨å…¥ designTokens (å¤ç”¨) âœ…                                 â”‚
â”‚                                                                  â”‚
â”‚  app/(main)/home/page.tsx                                        â”‚
â”‚  â””â”€â”€ <LegacyPageWrapper /> (é€‚é…å™¨)                             â”‚
â”‚      â”‚                                                           â”‚
â”‚      â”œâ”€â”€ å¯¼å…¥ @/index (Legacy èšåˆå™¨) âš ï¸                        â”‚
â”‚      â”‚   â”œâ”€â”€ navigationComponent                                â”‚
â”‚      â”‚   â”œâ”€â”€ allStyles (æ‰€æœ‰ Legacy æ ·å¼)                       â”‚
â”‚      â”‚   â””â”€â”€ allScripts (æ‰€æœ‰ Legacy è„šæœ¬)                      â”‚
â”‚      â”‚                                                           â”‚
â”‚      â””â”€â”€ å¯¼å…¥åŠŸèƒ½æ¨¡å— âš ï¸                                         â”‚
â”‚          â”œâ”€â”€ @/features/get-started                             â”‚
â”‚          â”œâ”€â”€ @/features/best-practices                          â”‚
â”‚          â”œâ”€â”€ @/features/how-to-implement                        â”‚
â”‚          â””â”€â”€ @/features/how-to-apply-cc                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Legacy ç³»ç»Ÿä¾èµ–é“¾ (æ—§)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  src/index.ts (èšåˆå™¨)                                           â”‚
â”‚  â”œâ”€â”€ components/layout/* (å¤´éƒ¨ã€ä¾§è¾¹æ )                         â”‚
â”‚  â”œâ”€â”€ components/navigation/* (å¯¼èˆªã€å¡ç‰‡)                       â”‚
â”‚  â”œâ”€â”€ styles/index.ts                                            â”‚
â”‚  â”‚   â”œâ”€â”€ designTokens.ts âœ… (å¤ç”¨)                              â”‚
â”‚  â”‚   â”œâ”€â”€ baseStyles.ts âš ï¸                                       â”‚
â”‚  â”‚   â”œâ”€â”€ componentStyles.ts âš ï¸                                  â”‚
â”‚  â”‚   â””â”€â”€ ... (å…¶ä»–æ ·å¼æ–‡ä»¶) âš ï¸                                  â”‚
â”‚  â””â”€â”€ scripts/index.ts                                           â”‚
â”‚      â”œâ”€â”€ sidebar.ts âš ï¸                                          â”‚
â”‚      â”œâ”€â”€ navigation.ts âš ï¸                                       â”‚
â”‚      â”œâ”€â”€ codeExamples.ts âš ï¸                                     â”‚
â”‚      â””â”€â”€ generated/* (æ„å»ºç”Ÿæˆ) âš ï¸                              â”‚
â”‚                                                                  â”‚
â”‚  features/* (åŠŸèƒ½æ¨¡å—)                                           â”‚
â”‚  â”œâ”€â”€ get-started/                                               â”‚
â”‚  â”œâ”€â”€ best-practices/                                            â”‚
â”‚  â”œâ”€â”€ how-to-implement/                                          â”‚
â”‚  â””â”€â”€ how-to-apply-cc/                                           â”‚
â”‚                                                                  â”‚
â”‚  client/* (å®¢æˆ·ç«¯æ¨¡å— - éœ€è¦æ„å»º)                               â”‚
â”‚  â”œâ”€â”€ bestPractices/                                             â”‚
â”‚  â”œâ”€â”€ howToImplement/                                            â”‚
â”‚  â””â”€â”€ howToApplyCC/                                              â”‚
â”‚      â””â”€â”€ æ„å»ºä¸º â†’ scripts/generated/*Bundle.ts                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å›¾ä¾‹ï¼š
âœ… å¤ç”¨èµ„æº - æ–°æ—§æ¶æ„éƒ½ä½¿ç”¨
âš ï¸  Legacy ä»£ç  - éœ€è¦éš”ç¦»
```

## ğŸ¯ éš”ç¦»åçš„æ¶æ„ï¼ˆæ¨èï¼‰

```
src/
â”œâ”€â”€ app/                          # Next.js App Router âœ¨
â”‚   â”œâ”€â”€ (main)/                   # ä¸»åº”ç”¨è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ home/                 # ä¸»é¡µï¼ˆä½¿ç”¨é€‚é…å™¨ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx          # â†’ LegacyPageWrapper
â”‚   â”‚   â”œâ”€â”€ dashboard/            # æ–°åŠŸèƒ½ç¤ºä¾‹
â”‚   â”‚   â””â”€â”€ settings/             # æ–°åŠŸèƒ½ç¤ºä¾‹
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ v1/messages/          # Claude API ä»£ç†
â”‚   â”‚   â””â”€â”€ img-proxy/            # å›¾ç‰‡ä»£ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx                # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx                  # æ ¹é¡µé¢
â”‚   â””â”€â”€ globals.css               # å…¨å±€æ ·å¼
â”‚
â”œâ”€â”€ components/              # React ç»„ä»¶ (æ–°æ¶æ„) âœ¨
â”‚   â”œâ”€â”€ ui/                       # shadcn/ui ç»„ä»¶
â”‚   â”œâ”€â”€ features/                 # åŠŸèƒ½ç»„ä»¶
â”‚   â”œâ”€â”€ layouts/                  # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ LegacyPageWrapper.tsx     # é€‚é…å™¨ï¼ˆè¿‡æ¸¡ç”¨ï¼‰
â”‚   â””â”€â”€ BrandIcon.tsx             # å“ç‰Œå›¾æ ‡
â”‚
â”œâ”€â”€ legacy/                       # Legacy ä»£ç ï¼ˆéš”ç¦»ï¼‰ ğŸ“¦
â”‚   â”œâ”€â”€ components/               # æ—§ç»„ä»¶
â”‚   â”œâ”€â”€ features/                 # æ—§åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ client/                   # æ—§å®¢æˆ·ç«¯ä»£ç 
â”‚   â”œâ”€â”€ styles/                   # æ—§æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ scripts/                  # æ—§è„šæœ¬æ–‡ä»¶
â”‚   â””â”€â”€ index.ts                  # æ—§èšåˆå™¨
â”‚
â”œâ”€â”€ api/                          # API é€»è¾‘ï¼ˆå¤ç”¨ï¼‰ âœ…
â”‚   â”œâ”€â”€ adapters/                 # æ ¼å¼è½¬æ¢
â”‚   â”œâ”€â”€ providers.ts              # ä¾›åº”å•†é…ç½®
â”‚   â””â”€â”€ types.ts                  # API ç±»å‹
â”‚
â”œâ”€â”€ lib/                          # å·¥å…·å‡½æ•°ï¼ˆå¤ç”¨ï¼‰ âœ…
â”‚   â”œâ”€â”€ utils/                    # é€šç”¨å·¥å…·
â”‚   â””â”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ config/                       # é…ç½®æ–‡ä»¶ï¼ˆå¤ç”¨ï¼‰ âœ…
â”‚   â””â”€â”€ navigation.ts             # å¯¼èˆªé…ç½®
â”‚
â”œâ”€â”€ types/                        # ç±»å‹å®šä¹‰ï¼ˆå¤ç”¨ï¼‰ âœ…
â”‚   â””â”€â”€ *.ts                      # å…±äº«ç±»å‹
â”‚
â””â”€â”€ styles/                       # æ ·å¼ç³»ç»Ÿ
    â”œâ”€â”€ designTokens.ts           # è®¾è®¡ä»¤ç‰Œï¼ˆå¤ç”¨ï¼‰ âœ…
    â””â”€â”€ globals.css               # å…¨å±€æ ·å¼ï¼ˆæ–°ï¼‰
```

## ğŸ”„ è°ƒç”¨å…³ç³»ï¼ˆéš”ç¦»åï¼‰

```
Next.js App Router
â”œâ”€â”€ app/layout.tsx
â”‚   â””â”€â”€ designTokens âœ…
â”‚
â””â”€â”€ app/(main)/home/page.tsx
    â””â”€â”€ <LegacyPageWrapper />
        â””â”€â”€ @/legacy/* (å®Œå…¨éš”ç¦») ğŸ“¦

æ–°åŠŸèƒ½å¼€å‘
â”œâ”€â”€ app/(main)/dashboard/page.tsx
â”‚   â”œâ”€â”€ @/components/features/* âœ¨
â”‚   â”œâ”€â”€ @/lib/utils/* âœ…
â”‚   â””â”€â”€ @/services/llm-provider/* âœ…
â”‚
â””â”€â”€ components/features/*
    â”œâ”€â”€ @/components/ui/* (shadcn/ui) âœ¨
    â”œâ”€â”€ @/lib/hooks/* âœ…
    â””â”€â”€ @/types/* âœ…
```

## ğŸ“‹ æ–‡ä»¶åˆ†ç±»è¯¦è§£

### âœ¨ æ–°æ¶æ„ï¼ˆNext.jsï¼‰

**å®Œå…¨ä½¿ç”¨ Next.js æœ€ä½³å®è·µ**

- `app/` - App Router è·¯ç”±
- `components/` - React ç»„ä»¶ï¼ˆshadcn/uiï¼‰
- ä½¿ç”¨ Server Componentsï¼ˆé»˜è®¤ï¼‰
- éœ€è¦äº¤äº’æ—¶ä½¿ç”¨ 'use client'
- Tailwind CSS + CSS å˜é‡

### âœ… å¤ç”¨èµ„æº

**æ–°æ—§æ¶æ„éƒ½å¯ä»¥ä½¿ç”¨**

- `api/` - API é€»è¾‘å’Œç±»å‹å®šä¹‰
- `lib/` - å·¥å…·å‡½æ•°å’Œ Hooks
- `config/` - é…ç½®æ–‡ä»¶
- `types/` - TypeScript ç±»å‹å®šä¹‰
- `styles/designTokens.ts` - è®¾è®¡ä»¤ç‰Œ

### ğŸ“¦ Legacy ä»£ç ï¼ˆéš”ç¦»ï¼‰

**åªé€šè¿‡é€‚é…å™¨ä½¿ç”¨ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹**

- `legacy/components/` - æ—§å¸ƒå±€ç»„ä»¶
- `legacy/features/` - æ—§åŠŸèƒ½æ¨¡å—
- `legacy/client/` - æ—§å®¢æˆ·ç«¯ä»£ç ï¼ˆéœ€æ„å»ºï¼‰
- `legacy/styles/` - æ—§æ ·å¼æ–‡ä»¶
- `legacy/scripts/` - æ—§è„šæœ¬æ–‡ä»¶

## ğŸš€ å¼€å‘æŒ‡å—

### æ–°åŠŸèƒ½å¼€å‘æµç¨‹

1. **åˆ›å»ºè·¯ç”±**

   ```bash
   src/app/(main)/new-feature/page.tsx
   ```

2. **åˆ›å»ºç»„ä»¶**

   ```bash
   src/components/features/NewFeature.tsx
   ```

3. **ä½¿ç”¨ shadcn/ui**

   ```bash
   npx shadcn@latest add button
   ```

4. **æ ·å¼ä½¿ç”¨ Tailwind**

   ```tsx
   <div className="bg-[var(--color-bg-primary)]">
   ```

5. **å¤ç”¨ API å’Œå·¥å…·**
   ```tsx
   import { fetchProviders } from '@/services/llm-provider/providers';
   import { cn } from '@/lib/utils';
   ```

### ç¦æ­¢æ“ä½œ

âŒ **ä¸è¦ä¿®æ”¹ `src/legacy/` ä¸‹çš„ä»»ä½•æ–‡ä»¶** âŒ **ä¸è¦åœ¨æ–°ä»£ç ä¸­å¯¼å…¥
`@/legacy/*`ï¼ˆé™¤äº†é€‚é…å™¨ï¼‰** âŒ **ä¸è¦æ··ç”¨æ—§çš„å­—ç¬¦ä¸²æ¨¡æ¿å’Œæ–°çš„ React ç»„ä»¶**

### è¿ç§»ç­–ç•¥

å½“éœ€è¦è¿ç§»æŸä¸ª legacy åŠŸèƒ½æ—¶ï¼š

1. åœ¨ `src/app/` åˆ›å»ºæ–°è·¯ç”±
2. åœ¨ `src/components/` ç”¨ React é‡å†™
3. æµ‹è¯•æ–°åŠŸèƒ½å®Œå…¨æ­£å¸¸
4. ä» `LegacyPageWrapper` ç§»é™¤æ—§æ¨¡å—
5. åˆ é™¤ `src/legacy/` ä¸­å¯¹åº”ä»£ç 

## ğŸ”§ æ„å»ºç³»ç»Ÿ

### å®¢æˆ·ç«¯ä»£ç æ„å»º

Legacy å®¢æˆ·ç«¯ä»£ç éœ€è¦æ„å»ºï¼š

```bash
npm run build:client
```

æ„å»ºæµç¨‹ï¼š

```
src/legacy/client/bestPractices/
  â””â”€â”€ index.ts
      â†“ esbuild
src/legacy/scripts/generated/
  â””â”€â”€ bestPracticesBundle.ts (IIFE)
      â†“ å¯¼å…¥
src/legacy/scripts/index.ts
  â””â”€â”€ allScripts
      â†“ æ³¨å…¥
LegacyPageWrapper
  â””â”€â”€ dangerouslySetInnerHTML
```

### Next.js æ„å»º

```bash
npm run build
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/LEGACY_ISOLATION_GUIDE.md` - å®Œæ•´éš”ç¦»æŒ‡å—
- `docs/QUICK_START_NEW_DEV.md` - æ–°æ¶æ„å¼€å‘å¿«é€Ÿå¼€å§‹
- `scripts/migrate-to-legacy.sh` - ä¸€é”®éš”ç¦»è„šæœ¬

## âš¡ ä¸€é”®éš”ç¦»

è¿è¡Œéš”ç¦»è„šæœ¬ï¼š

```bash
./scripts/migrate-to-legacy.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š

1. âœ… åˆ›å»º `src/legacy/` ç›®å½•
2. âœ… ç§»åŠ¨æ‰€æœ‰ Legacy ä»£ç 
3. âœ… ä¿ç•™å…±äº«èµ„æº
4. âœ… æ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„
5. âœ… é‡æ–°æ„å»ºå®¢æˆ·ç«¯ä»£ç 
6. âœ… éªŒè¯ Next.js æ„å»º

éš”ç¦»åéªŒè¯ï¼š

- [ ] `npm run dev` å¯åŠ¨æ­£å¸¸
- [ ] è®¿é—® http://localhost:3000 é¡µé¢æ­£å¸¸
- [ ] æ‰€æœ‰åŠŸèƒ½æ¨¡å—æ­£å¸¸æ˜¾ç¤º
- [ ] æ§åˆ¶å°æ— é”™è¯¯
