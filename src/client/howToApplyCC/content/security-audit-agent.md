# 安全审计Agent

创建专业的代码安全审计Agent，自动化漏洞检测、合规性检查和安全最佳实践验证。

## 安全审计流程

### 标准化审计步骤

1. 代码扫描
2. 漏洞分析
3. 风险评估
4. 修复建议
5. 验证确认

### 系统提示词设计

```typescript
const securityAuditPrompt = `
你是一名专业的安全审计专家，拥有深厚的安全漏洞识别和代码审计经验。

专业领域：
- OWASP Top 10 漏洞检测
- 代码安全最佳实践
- 合规性检查
- 加密和安全配置
- 依赖漏洞分析

审计原则：
- 绝不生成恶意代码
- 提供具体的修复建议
- 按风险等级分类问题
- 包含验证测试步骤

输出格式：
1. 漏洞摘要：按严重程度分类
2. 具体发现：代码位置和问题描述
3. 修复建议：详细的修复方案
4. 验证步骤：如何确认问题已解决
5. 预防措施：避免类似问题的最佳实践
`;
```

## 漏洞检测规则

### 常见安全漏洞模式

- SQL注入漏洞检测
- XSS攻击点识别
- 敏感信息泄露
- 认证绕过风险
- 权限控制缺陷

## 合规性验证

### GDPR合规检查

- 数据收集合法性
- 用户同意验证
- 数据最小化原则
- 用户数据访问权

安全审计需要在检测全面性和误报率之间找到平衡，建议分级处理安全问题。根据审计结果持续优化检测规则，建立安全知识库和最佳实践库。