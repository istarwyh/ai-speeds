# 上下文管理 - 精准沟通与高效协作的艺术

掌握 Claude Code 的上下文管理技巧，包括项目记忆库的使用和长期记忆的维护。

## 1. 详细的指令

### 1.1 指令对比

**对比示例**：

| ❌ 模糊指令 | ✅ 详细指令 |
|-----------|-----------|
| "添加测试" | "为 UserService 的 login 方法添加测试，验证密码错误时抛出 AuthenticationError" |
| "修复 bug" | "修复 Issue #123：用户登出后仍然可以访问受保护页面" |
| "优化性能" | "优化 /api/users 接口，将响应时间从 2s 降低到 500ms 以内" |

### 1.2 精准用词

- `"think"` 代表一般的思考
- `"think more"`、`"think harder"` 代表更多的思考

值得一提的是，让 LLM 更多地思考还有很多方法，比如使用 `<think>` 的 COT 和 few-shot，或者使用 sequential-thinking MCP。

## 2. 上下文管理策略

### 2.1 保持专注

```bash
# 清除不相关上下文
/clear

# 聚焦特定目录
# 或者直接切到这个目录再使用 Claude Code
"请专注于 @src/auth/ 目录下的文件"

# 使用检查清单
"创建一个修复 lint 错误的检查清单，逐项完成"
```

### 2.2 上下文窗口优化

**最大化利用有限的上下文窗口**：

1. **分层信息**：重要信息放在前面
2. **结构化描述**：使用清晰的格式和标题
3. **关键词突出**：重要概念用粗体或特殊标记
4. **渐进式详细**：先概述，再深入细节

## 3. 数据输入方式

### 3.1 多种输入方法

```bash
# 1. 直接粘贴
# 直接复制粘贴内容到对话中

# 2. 管道输入
cat error.log | claude "分析这些错误日志"

# 3. 文件读取
"请读取 data/users.csv 并分析用户分布"

# 4. 如果文件就在当前目录下直接 @
"请读取 @users.csv 并分析用户分布"

# 5. URL 获取，注意网络是否需要 VPN
"请分析 https://api.github.com/users/octocat 的响应结构"

# 6. 引用 MCP Resources，当连接了 MCP，格式是 @server:resource
"看看现在有哪些 issue：@github:repos/owner/repo/issues"
```

### 3.2 结合图片开发

CC 虽然跑在命令行里面，但是可以向对话中添加图片！

**图片输入方法**：

- **拖放**：将图片拖放到 Claude Code 窗口中
- **粘贴**：复制图片，然后使用 `Ctrl + V` 将其粘贴到 CLI 中（不是 `Cmd + V`）
- **路径引用**：向 Claude 提供图片路径

**示例用法**：

```bash
"根据截图结果：/path/to/your/image.png 调整样式，使用 Puppeteer 截图对比设计稿，直到匹配设计稿"
```

## 4. 项目记忆库设计

### 4.1 记忆库结构

**有效的项目记忆库应该包含**：

```markdown
# 项目概述
- 项目目标和核心功能
- 技术架构和设计决策
- 关键业务逻辑说明

# 开发规范
- 代码风格和命名约定
- 测试策略和覆盖要求
- 提交和部署流程

# 重要约束
- 性能要求和限制
- 安全考虑和合规要求
- 兼容性和依赖管理

# 常见问题
- 已知问题和解决方案
- 调试技巧和工具使用
- 部署和运维注意事项
```

### 4.2 记忆库维护

**最佳实践**：

1. **定期更新**：随着项目发展及时更新记忆库
2. **版本控制**：将记忆库文件纳入版本控制
3. **分层管理**：全局、项目、模块多层级记忆库
4. **团队协作**：团队成员共同维护和完善

## 5. 长期记忆管理

### 5.1 知识积累

**建立个人知识库**：

- **技术笔记**：记录学习的新技术和最佳实践
- **问题解决**：记录遇到的问题和解决方案
- **项目经验**：总结项目中的经验和教训
- **工具使用**：记录常用工具的配置和技巧

### 5.2 知识检索

**高效检索策略**：

- **标签系统**：为知识条目添加标签
- **关键词索引**：建立关键词索引
- **分类组织**：按技术栈或项目类型分类
- **定期回顾**：定期回顾和整理知识库

## 6. 高级技巧

### 6.1 上下文链接

**建立知识间的联系**：

- **交叉引用**：在相关知识点间建立引用
- **依赖关系**：明确知识点间的依赖关系
- **演进历史**：记录知识点的演进过程
- **应用场景**：记录知识点的具体应用场景

### 6.2 智能提示

**提高 AI 理解准确性**：

- **背景说明**：提供充分的背景信息
- **期望输出**：明确说明期望的输出格式
- **约束条件**：列出相关的约束和限制
- **示例参考**：提供相似场景的示例

## 7. 效果评估

**衡量上下文管理效果**：

- **响应准确性**：AI 回答的准确程度
- **理解深度**：AI 对问题的理解深度
- **解决效率**：问题解决的速度
- **知识复用**：知识的复用程度

💡 **高级技巧**：合理的上下文管理可以让 Claude Code 的表现提升 50% 以上！

通过系统化的上下文管理，可以显著提升与 Claude Code 协作的效率和质量。
